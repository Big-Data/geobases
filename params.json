{"google":"","body":"GeoBases\r\n========\r\n\r\nIntroduction\r\n------------\r\n\r\nThis module is a general class *GeoBase* to manipulate geographical\r\ndata. It loads static csv files containing data about airports or train\r\nstations, and then provides tools to play with it. This is entirely\r\nwritten in Python.\r\n\r\nIt relies on three other modules:\r\n\r\n-   *GeoUtils*: to compute haversine distances between points\r\n-   *LevenshteinUtils*: to calculate distances between strings. Indeed,\r\n    we need a good tool to do it, in order to recognize things like\r\n    station names in schedule files where we do not have the station id\r\n-   *GeoGridModule*: a class implementing a geographical index based on\r\n    geohashing\r\n\r\nProject\r\n-------\r\n\r\n### Prerequisites\r\n\r\nThese prerequisites are very standard packages which are often installed\r\nby default on Linux distributions. But make sure you have them anyway.\r\n\r\nFirst you need to install *setuptools*:\r\n\r\n    # apt-get install python-setuptools    # for debian\r\n    # yum install python-setuptools.noarch # for fedora\r\n\r\nThen you need some basics compilation stuff to compile dependencies:\r\n\r\n    # apt-get install python-dev g++    # for debian\r\n    # yum install python-devel gcc-c++  # for fedora\r\n\r\n### Installation\r\n\r\nTo clone the project from\r\n[github](https://github.com/opentraveldata/geobases.git):\r\n\r\n    % git clone https://github.com/opentraveldata/geobases.git\r\n\r\nThen install the package:\r\n\r\n    % cd geobases\r\n    % python setup.py install --user\r\n\r\nThis should install some dependencies.\r\n\r\nA standalone script is put in `~/.local/bin`, to benefit from it, put\r\nthat in your `~/.bashrc` or `~/.zshrc`:\r\n\r\n    export PATH=$PATH:$HOME/.local/bin\r\n    export BACKGROUND_COLOR=black # or 'white', your call\r\n\r\nIf you use zsh and want to benefit from the *autocomplete*, add this to\r\nyour `~/.zshrc`:\r\n\r\n    # Add custom completion scripts\r\n    fpath=(~/.zsh/completion $fpath)\r\n    autoload -U compinit\r\n    compinit\r\n\r\nTests\r\n-----\r\n\r\nYou may try to run the tests with:\r\n\r\n    % find ./ -name '*.pyc' -exec rm {} \\;\r\n    % python test/test_GeoBases.py -v\r\n\r\nQuickstart\r\n----------\r\n\r\nTo load the class, just import the main class with:\r\n\r\n    % python\r\n    >>> from GeoBases import GeoBase\r\n    >>> geo_o = GeoBase(data='ori_por', verbose=False)\r\n    >>> geo_a = GeoBase(data='airports', verbose=False)\r\n    >>> geo_t = GeoBase(data='stations', verbose=False)\r\n\r\nYou may provide other values than *data=\"ori\\_por\"*, *data=\"airports\"*\r\nor *data=\"stations\"*. Here is an overview:\r\n\r\n-   *data=\"ori\\_por\"* will load a local version of this\r\n    [file](https://github.com/opentraveldata/optd/raw/trunk/refdata/ORI/ori_por_public.csv)\r\n-   *data=\"ori\\_por\\_multi\"* is the same as previous, but the key for a\r\n    line is not the iata\\_code, but the concatenation of iata\\_code and\r\n    location\\_type. This feature makes every line unique, whereas\r\n    *ori\\_por* may have several lines for one iata\\_code, and duplicates\r\n    are dropped. \\_\\_id\\_\\_ is the special field containing the key.\r\n-   *data=\"airports\"* will use geonames as data source for airports\r\n-   *data=\"stations\"* will use RFF data, from [the open data\r\n    website](http://www.data.gouv.fr), as data source for french train\r\n    stations\r\n-   *data=\"stations\\_nls\"* will use NLS nomenclature as data source for\r\n    french train stations\r\n-   *data=\"stations\\_uic\"* will use UIC nomenclature as data source for\r\n    french train stations\r\n-   *data=\"countries\"* will load data on countries\r\n-   *data=\"capitals\"* will load data on countries capitals\r\n-   *data=\"continents\"* will load data on continents\r\n-   *data=\"timezones\"* will load data on timezones\r\n-   *data=\"languages\"* will load data on languages\r\n-   *data=\"cities\"* will load data on cities, extracted from geonames\r\n-   *data=\"currencies\"* will load data on currencies, extracted from\r\n    wikipedia\r\n-   *data=\"airlines\"* will load data on airlines, extracted from this\r\n    [file](https://raw.github.com/opentraveldata/optd/trunk/refdata/ORI/ori_airlines.csv)\r\n-   *data=\"cabins\"* will load data on cabins\r\n-   *data=\"locales\"* will load data on locales\r\n-   *data=\"location\\_types\"* will load data on location types\r\n-   *data=\"feature\\_classes\"* will load data on feature classes\r\n-   *data=\"feature\\_codes\"* will load data on feature codes\r\n-   *data=\"ori\\_por\\_non\\_iata\"* will load some non-iata data excluded\r\n    from *ori\\_por*\r\n-   *data=\"geonames\\_MC\"* will load MC data of geonames\r\n-   *data=\"geonames\\_FR\"* will load FR data of geonames\r\n-   *data=\"postal\\_codes\\_MC\"* will load MC postal codes data\r\n-   *data=\"postal\\_codes\\_FR\"* will load FR postal codes data\r\n-   *data=\"feed\"* will create an empty instance\r\n\r\nAll features are then data independent, and are available as long as\r\ngeocodes are included in the data sources (which is not the case for\r\ncountries or NLS nomenclature).\r\n\r\nFeatures\r\n--------\r\n\r\n### Information access\r\n\r\n    >>> geo_a.get('CDG', 'city_code')\r\n    'PAR'\r\n    >>> geo_a.get('BRU', 'name')\r\n    'Bruxelles National'\r\n    >>> geo_t.get('frnic', 'name')\r\n    'Nice-Ville'\r\n    >>> geo_t.get('fr_not_exist', 'name', default='NAME')\r\n    'NAME'\r\n\r\n### Find airports with properties\r\n\r\n    >>> conditions = [('city_code', 'PAR'), ('location_type', 'H')]\r\n    >>> list(geo_o.getKeysWhere(conditions, mode='and'))\r\n    ['JDP', 'JPU']\r\n    >>> conditions = [('city_code', 'PAR'), ('city_code', 'LON')]\r\n    >>> len(list(geo_o.getKeysWhere(conditions, mode='or')))\r\n    36\r\n\r\n### Distance calculation\r\n\r\n    >>> geo_a.distance('CDG', 'NCE')\r\n    694.5162...\r\n\r\n### Find airports near a point\r\n\r\n    >>> # Paris, airports <= 50km\r\n    >>> [k for _, k in sorted(geo_a.findNearPoint((48.84, 2.367), 40))]\r\n    ['ORY', 'LBG', 'TNF', 'CDG']\r\n    >>>\r\n    >>> # Nice, stations <= 5km\r\n    >>> [geo_t.get(k, 'name') for _, k in geo_t.findNearPoint((43.70, 7.26), 4)]\r\n    ['Nice-Ville', 'Nice-St-Roch', 'Nice-Riquier']\r\n\r\n### Find airports near a key\r\n\r\n    >>> sorted(geo_a.findNearKey('ORY', 50)) # Orly, airports <= 50km\r\n    [(0.0, 'ORY'), (18.8..., 'TNF'), (27.8..., 'LBG'), (34.8..., 'CDG')]\r\n    >>>\r\n    >>> sorted(geo_t.findNearKey('frnic', 3)) # Nice station, stations <= 3km\r\n    [(0.0, 'frnic'), (2.2..., 'fr4342'), (2.3..., 'fr5737')]\r\n\r\n### Find closest airports from a point\r\n\r\n    >>> list(geo_a.findClosestFromPoint((43.70, 7.26))) # Nice\r\n    [(5.82..., 'NCE')]\r\n    >>>\r\n    >>> list(geo_a.findClosestFromPoint((43.70, 7.26), N=3)) # Nice\r\n    [(5.82..., 'NCE'), (30.28..., 'CEQ'), (79.71..., 'ALL')]\r\n\r\n### Approximate name matching\r\n\r\n    >>> geo_t.fuzzyGet('Marseille Charles', 'name')[0]\r\n    (0.8..., 'frmsc')\r\n    >>> geo_a.fuzzyGet('paris de gaulle', 'name')[0]\r\n    (0.78..., 'CDG')\r\n\r\n### Map display\r\n\r\n    >>> geo_t.visualize()\r\n    * Added lines for duplicates linking, total 0\r\n    > Affecting category None     to color blue    | volume 3190\r\n    <BLANKLINE>\r\n    * Now you may use your browser to visualize:\r\n    example_map.html example_table.html\r\n    <BLANKLINE>\r\n    * If you want to clean the temporary files:\r\n    rm example.json ...\r\n    <BLANKLINE>\r\n    (['example_map.html', 'example_table.html'], 2)\r\n\r\n![image](https://raw.github.com/opentraveldata/geobases/public/examples/GeoBases-map.png)\r\nStandalone script\r\n-----------------\r\n\r\nInstallation of the package will also deploy a standalone script named\r\n`GeoBase`.\r\n\r\nThen you may use:\r\n\r\n    % GeoBase ORY CDG              # query on the keys ORY and CDG\r\n    % GeoBase --closest CDG        # closest from CDG\r\n    % GeoBase --near LIG           # near LIG\r\n    % GeoBase --fuzzy marseille    # fuzzy search on 'marseille'\r\n    % GeoBase --help\r\n\r\n![image](https://raw.github.com/opentraveldata/geobases/public/examples/GeoBases-CLI.png)\r\nMore examples here, for example how to do a search on a field, like\r\nadmin code (french riviera here):\r\n\r\n    % GeoBase -E adm1_code -e B8\r\n\r\nSame with programmer-friendly output (csv-like, controlled with\r\n`--show`):\r\n\r\n    % GeoBase -E adm1_code -e B8 --quiet --show __ref__ iata_code  name\r\n\r\nAdd a fuzzy name search:\r\n\r\n    % GeoBase -E adm1_code -e B8 --fuzzy sur mer\r\n\r\nAll heliports under 200 km from Paris:\r\n\r\n    % GeoBase --near PAR -N 200 -E location_type -e 'H'\r\n\r\n50 train stations closest to Paris:\r\n\r\n    % GeoBase -E location_type -e R --closest PAR -C 50\r\n\r\nCountries with non-empty postal code regex:\r\n\r\n    % GeoBase -b countries -E postal_code_regex -e \"\" --reverse --quiet\r\n\r\nReading data input on stdin:\r\n\r\n    % echo -e 'ORY^Orly\\nCDG^Charles' | GeoBase\r\n\r\nDisplay on map:\r\n\r\n    % GeoBase -b stations --map\r\n\r\nEurope marker-less map:\r\n\r\n    % GeoBase -E region_code -e EUROP -m -M _ _ country_code  __none__\r\n\r\nPackaging\r\n---------\r\n\r\nTo create source distribution (pip-installable):\r\n\r\n    % python setup.py sdist --format=zip\r\n\r\nTo create rpm packages:\r\n\r\n    % rm -rf build dist *.egg-info\r\n    % python setup.py bdist_rpm\r\n\r\nThe `MANIFEST.in` file is used to determine which files will be included\r\nin a source distribution. `package_data` directive in `setup.py` file is\r\nabout which file will be exported in site-package after installation. So\r\nyou really need both if you want to produce installable packages like\r\nrpms or zip which can be installed afterwards.\r\n\r\nYou will also find a [Rakefile](http://rake.rubyforge.org/) at the\r\nroot of the project. This may be used to build and deploy the packages.\r\nDeployment may be done using webdav, and the Rakefile expects `nd` to be\r\ninstalled (this is a webdav client). To install nd, fetch the sources\r\nfrom\r\n[[http://www.gohome.org/nd](http://www.gohome.org/nd)/](http://www.gohome.org/nd/).\r\nThen compile and install them. On 64 bits Fedora, you need to install\r\nlibxml2 before:\r\n\r\n    # yum install libxml2.x86_64 libxml2-devel.x86_64\r\n\r\nAfter nd and rake installation, you may try:\r\n\r\n    % rake\r\n\r\nVirtualenv has bugs on 64 bits systems, if you are using such a system,\r\nyou absolutely need to upgrade to the very last unreleased version of\r\nvirtualenv, before executing rake:\r\n\r\n    % pip uninstall virtualenv\r\n    % pip install --user https://github.com/pypa/virtualenv/tarball/develop","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"GeoBases","tagline":"Data services and visualization"}